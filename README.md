# 网络安全技术大作业 - 加密通信与攻击演示系统

## 项目简介

这是一个综合性的网络安全演示系统，展示了以下内容：

1. **哈夫曼编码** - 数据压缩算法
2. **RSA加密** - 非对称加密算法
3. **安全通信系统** - 结合压缩和加密的端到端通信
4. **中间人攻击 (MITM)** - 攻击和防御演示
5. **时间攻击 (Timing Attack)** - 侧信道攻击演示

## 项目结构

```
assessment/
├── huffman.py              # 哈夫曼编码实现
├── rsa_crypto.py          # RSA加密实现（包含易受攻击和安全版本）
├── secure_communication.py # 安全通信系统
├── mitm_attack.py         # 中间人攻击模拟
├── timing_attack.py       # 时间攻击模拟
├── main.py               # 主程序（交互式菜单）
├── requirements.txt      # 项目依赖
└── README.md            # 本文件
```

## 安装依赖

### 基本依赖
```bash
pip install -r requirements.txt
```

### 可选依赖（用于时间攻击可视化）
```bash
pip install matplotlib
```

## 运行方法

### 方式1: 运行主程序（推荐）
交互式菜单，可以选择运行各个模块：
```bash
python main.py
```

### 方式2: 单独运行各个模块

#### 1. 哈夫曼编码演示
```bash
python huffman.py
```

#### 2. RSA加密演示
```bash
python rsa_crypto.py
```

#### 3. 安全通信系统演示
```bash
python secure_communication.py
```

#### 4. 中间人攻击演示
```bash
python mitm_attack.py
```

#### 5. 时间攻击演示
```bash
python timing_attack.py
```

## 功能详解

### 1. 哈夫曼编码 (huffman.py)

**原理：**
- 基于字符频率的前缀编码
- 高频字符使用短编码，低频字符使用长编码
- 无损压缩算法

**功能：**
- 构建哈夫曼树
- 生成编码表
- 编码和解码文本
- 计算压缩率

**示例输出：**
```
原始文本: hello world!
原始长度: 12 字符 (96 比特)
编码后长度: 45 比特
压缩率: 53.13%
```

### 2. RSA加密 (rsa_crypto.py)

**原理：**
- 非对称加密算法
- 使用公钥加密，私钥解密
- 基于大数分解的困难性

**功能：**
- 生成RSA密钥对
- 加密和解密整数
- 加密和解密字符串（分块处理）
- 提供易受攻击和安全的实现版本

**实现细节：**
- 使用Miller-Rabin素性测试生成大素数
- 默认公钥指数：65537
- 支持可配置的密钥大小（默认1024位）

### 3. 安全通信系统 (secure_communication.py)

**工作流程：**

**发送方：**
1. 使用哈夫曼编码压缩消息
2. 使用接收方的RSA公钥加密压缩数据
3. 发送加密的传输包

**接收方：**
1. 使用自己的RSA私钥解密
2. 使用哈夫曼解码恢复原始消息

**优势：**
- 压缩减少数据量，提高传输效率
- RSA加密保证机密性
- 端到端加密，只有收发双方能读取

### 4. 中间人攻击 (mitm_attack.py)

**演示场景：**

#### 场景1：失败的中间人攻击
- Alice和Bob正确交换了公钥
- 攻击者可以拦截加密数据，但无法解密
- **结论：** 正确的密钥交换可以防御攻击

#### 场景2：成功的中间人攻击
- 攻击者控制密钥交换过程
- Alice以为收到Bob的公钥（实际是攻击者的）
- Bob以为收到Alice的公钥（实际是攻击者的）
- 攻击者可以解密、修改、重新加密消息
- **结论：** 密钥交换阶段是关键漏洞

**防御方法：**
1. 使用数字证书和PKI体系
2. 密钥指纹验证（带外验证）
3. 使用带认证的密钥交换协议
4. 端到端加密
5. 检测证书变化

### 5. 时间攻击 (timing_attack.py)

**攻击原理：**
- 测量加密/解密操作的时间
- 不同的密钥位导致不同的计算时间
- 通过统计分析推断密钥信息

**演示内容：**

#### 易受攻击的实现
- 使用简单的模幂运算
- 时间与密钥位数相关
- 容易被时间攻击

#### 安全的实现
- 使用优化的算法
- 添加随机延迟
- 时间变化更小，更难攻击

#### 对比结果
- 测量并比较两种实现的时间分布
- 生成可视化图表（需要matplotlib）
- 展示安全实现的优势

**防御方法：**
1. 使用常量时间算法
2. 添加随机延迟
3. Blinding技术
4. 硬件加密加速
5. 批处理操作

## 技术特点

### 哈夫曼编码
- ✅ 完整的哈夫曼树构建
- ✅ 高效的编码和解码
- ✅ 压缩率统计
- ✅ 支持任意文本

### RSA加密
- ✅ Miller-Rabin素性测试
- ✅ 扩展欧几里得算法
- ✅ 分块加密支持长消息
- ✅ 易受攻击和安全版本对比

### 中间人攻击
- ✅ 真实的攻击场景模拟
- ✅ 成功和失败的攻击对比
- ✅ 详细的攻击过程展示
- ✅ 防御建议

### 时间攻击
- ✅ 精确的时间测量
- ✅ 统计分析
- ✅ 可视化对比（可选）
- ✅ 多种防御技术展示

## 性能说明

### 密钥大小
- **默认：** 512位（演示用，速度快）
- **生产环境推荐：** 2048位或更高

### 运行时间
- 哈夫曼编码：< 1秒
- RSA密钥生成（512位）：1-3秒
- 安全通信演示：5-10秒
- 中间人攻击演示：10-20秒
- 时间攻击演示：30-60秒

## 教育价值

这个项目展示了：

1. **密码学基础**
   - 对称与非对称加密
   - 数据压缩与加密的结合
   - 密钥管理的重要性

2. **网络安全威胁**
   - 中间人攻击的原理和危害
   - 侧信道攻击（时间攻击）
   - 攻击者的思维方式

3. **安全防御**
   - 如何设计安全的系统
   - 防御措施的实现
   - 安全与性能的权衡

4. **实践经验**
   - 完整的加密通信系统
   - 真实的攻击模拟
   - 可测量的安全改进

## 注意事项

⚠️ **本项目仅用于教育目的**

- 不应用于生产环境
- RSA实现未经过充分的安全审计
- 密钥大小仅供演示（实际应用需要更大的密钥）
- 缺少完整的错误处理和边界情况处理

## 扩展建议

如果想进一步学习，可以：

1. **增加其他加密算法**
   - AES对称加密
   - 椭圆曲线加密(ECC)
   - Diffie-Hellman密钥交换

2. **实现更多攻击**
   - 重放攻击
   - 选择密文攻击
   - 填充预言攻击

3. **添加网络通信**
   - 使用socket实现真实网络通信
   - 模拟TCP/IP协议栈
   - 实现SSL/TLS握手

4. **增强可视化**
   - 实时显示攻击过程
   - 交互式图形界面
   - 网络拓扑可视化

5. **添加数字签名**
   - 实现RSA签名
   - 消息认证码(MAC)
   - 数字证书管理

## 参考资料

- [RSA算法详解](https://en.wikipedia.org/wiki/RSA_(cryptosystem))
- [哈夫曼编码原理](https://en.wikipedia.org/wiki/Huffman_coding)
- [中间人攻击](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)
- [时间攻击](https://en.wikipedia.org/wiki/Timing_attack)

## 作者

网络安全技术课程作业

## 许可

本项目仅用于教育目的。

